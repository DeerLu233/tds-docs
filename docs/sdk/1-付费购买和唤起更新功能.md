---
id: tap-fun-paysdk
title: 付费购买 & 唤起更新
sidebar_label: 付费购买 & 唤起更新
---

import {Gray,Blue, Red, Black,Link,ImageLink} from '../component';


## 付费认证

<Gray>为了游戏售卖服务的功能，避免 APK 流出导致盗版横行；当游戏准备在 TapTap 开放售卖时，可以接入此功能。</Gray>

### 1. 设置授权回调

```cs
//默认情况下 SDK 会弹出不可由玩家手动取消的弹窗来避免未授权玩家进入游戏，如果需要回调来触发流程，请添加如下代码
TapLicense.SetLicencesCallback(ITapLicenseCallback callback);

public interface ITapLicenseCallback
{
    // 授权成功回调
    void OnLicenseSuccess();
}

```

### 2. 检查付费授权

```cs
TapLicense.Check();
```

## DLC 查询和购买

### 1. DLC 回调设置

```cs
public class MyTapDLCCallback:ITapDlcCallback
{
    public void OnQueryCallBack(TapLicenseQueryCode code, Dictionary<string, object> queryList)
    {
        
    }

    public void OnOrderCallBack(string sku, TapLicensePurchasedCode status)
    {
        
    }
}

TapLicense.SetDLCCallback(new MyTapDLCCallback());

```

### 2. DLC 查询

```cs
TapLicense.QueryDLC(string[] skuIds);
```


### 3. DLC 购买

```cs
TapLicense.PurchaseDLC(string skuId);
```

### 参数说明
#### TapLicenseQueryCode
回调          | 回调值 | 说明       |
----------- | --- | -------- |
QUERY_RESULT_OK       | 0   | 动态发布成功     |
QUERY_RESULT_NOT_INSTALL_TAPTAP       | 1   | 动态发布成功     |
QUERY_RESULT_ERR       | 2   | 动态发布成功     |
ERROR_CODE_UNDEFINED       | 80000   | 动态发布成功     |


#### skuId:
内购商品id，需要在admin后台配置

## 唤起TapTap检查更新

```cs
TapCommon.UpdateGameInTapTap("appid", callSuccess =>
{
    if (callSuccess) {
        Debug.Log("TapTap唤起成功");
    }
});
```
appid: 游戏在 TapTap 商店的唯一身份标识  
例如：https://www.taptap.com/app/187168 ，其中 "187168" 是 appid
